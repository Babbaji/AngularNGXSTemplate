{"version":3,"file":"ngxs-entity.umd.js","sources":["../src/entity_state.ts","../src/state_selectors.ts","../src/state_adapter.ts","../src/unsorted_state_adapter.ts","../src/sorted_state_adapter.ts","../src/create_adapter.ts","../src/models.ts"],"sourcesContent":["import { EntityState } from './models'\n\nexport function getInitialEntityState<V>(): EntityState<V> {\n  return {\n    ids: [],\n    entities: {}\n  }\n}\n\nexport function createInitialStateFactory<V>() {\n  function getInitialState(): EntityState<V>\n  function getInitialState<S extends object>(additionalState: S): EntityState<V> & S\n  function getInitialState(additionalState: any = {}): any {\n    return Object.assign(getInitialEntityState(), additionalState)\n  }\n\n  return { getInitialState }\n}\n","import { EntityState, EntitySelectors } from './models'\n\nexport function createSelectorsFactory<T>() {\n  function getSelectors(): EntitySelectors<T, any> {\n    const selectIds = (state: any) => state.ids\n    const selectEntities = (state: EntityState<T>) => state.entities\n    const selectAll = (state: EntityState<T>): any =>\n      selectIds(state).map((id: any) => (selectEntities(state) as any)[id])\n\n    const selectTotal = (state: EntityState<T>) => selectIds(state).length\n\n    return {\n      selectIds,\n      selectEntities,\n      selectAll,\n      selectTotal\n    }\n  }\n\n  return { getSelectors }\n}\n","import { EntityState } from './models'\n\nexport enum DidMutate {\n  EntitiesOnly,\n  Both,\n  None\n}\n\nexport function createStateOperator<V, R>(\n  mutator: (arg: R, state: EntityState<V>) => DidMutate\n): EntityState<V>\nexport function createStateOperator<V, R>(mutator: (arg: any, state: any) => DidMutate): any {\n  return function operation<S extends EntityState<V>>(arg: R, state: any): S {\n    const clonedEntityState: EntityState<V> = {\n      ids: [...state.ids],\n      entities: { ...state.entities }\n    }\n\n    const didMutate = mutator(arg, clonedEntityState)\n\n    if (didMutate === DidMutate.Both) {\n      return Object.assign({}, state, clonedEntityState)\n    }\n\n    if (didMutate === DidMutate.EntitiesOnly) {\n      return {\n        ...state,\n        entities: clonedEntityState.entities\n      }\n    }\n\n    return state\n  }\n}\n","import { EntityState, EntityStateAdapter, IdSelector, Update } from './models'\nimport { createStateOperator, DidMutate } from './state_adapter'\n\nexport function createUnsortedStateAdapter<T>(selectId: IdSelector<T>): EntityStateAdapter<T>\nexport function createUnsortedStateAdapter<T>(selectId: IdSelector<T>): any {\n  type R = EntityState<T>\n\n  function addOneMutably(entity: T, state: R): DidMutate\n  function addOneMutably(entity: any, state: any): DidMutate {\n    const key = selectId(entity)\n\n    if (key in state.entities) {\n      return DidMutate.None\n    }\n\n    state.ids.push(key)\n    state.entities[key] = entity\n\n    return DidMutate.Both\n  }\n\n  function addManyMutably(entities: T[], state: R): DidMutate\n  function addManyMutably(entities: any[], state: any): DidMutate {\n    let didMutate = false\n\n    for (const entity of entities) {\n      didMutate = addOneMutably(entity, state) !== DidMutate.None || didMutate\n    }\n\n    return didMutate ? DidMutate.Both : DidMutate.None\n  }\n\n  function addAllMutably(entities: T[], state: R): DidMutate\n  function addAllMutably(entities: any[], state: any): DidMutate {\n    state.ids = []\n    state.entities = {}\n\n    addManyMutably(entities, state)\n\n    return DidMutate.Both\n  }\n\n  function removeOneMutably(key: T, state: R): DidMutate\n  function removeOneMutably(key: any, state: any): DidMutate {\n    return removeManyMutably([key], state)\n  }\n\n  function removeManyMutably(keys: T[], state: R): DidMutate\n  function removeManyMutably(keys: any[], state: any): DidMutate {\n    const didMutate =\n      keys.filter(key => key in state.entities).map(key => delete state.entities[key]).length > 0\n\n    if (didMutate) {\n      state.ids = state.ids.filter((id: any) => id in state.entities)\n    }\n\n    return didMutate ? DidMutate.Both : DidMutate.None\n  }\n\n  function removeAll<S extends R>(state: S): S\n  function removeAll<S extends R>(state: any): S {\n    return Object.assign({}, state, {\n      ids: [],\n      entities: {}\n    })\n  }\n\n  function takeNewKey(keys: { [id: string]: string }, update: Update<T>, state: R): void\n  function takeNewKey(keys: { [id: string]: any }, update: Update<T>, state: any): boolean {\n    const original = state.entities[update.id]\n    const updated: T = Object.assign({}, original, update.changes)\n    const newKey = selectId(updated)\n    const hasNewKey = newKey !== update.id\n\n    if (hasNewKey) {\n      keys[update.id] = newKey\n      delete state.entities[update.id]\n    }\n\n    state.entities[newKey] = updated\n\n    return hasNewKey\n  }\n\n  function updateOneMutably(update: Update<T>, state: R): DidMutate\n  function updateOneMutably(update: any, state: any): DidMutate {\n    return updateManyMutably([update], state)\n  }\n\n  function updateManyMutably(updates: Update<T>[], state: R): DidMutate\n  function updateManyMutably(updates: any[], state: any): DidMutate {\n    const newKeys: { [id: string]: string } = {}\n\n    updates = updates.filter(update => update.id in state.entities)\n\n    const didMutateEntities = updates.length > 0\n\n    if (didMutateEntities) {\n      const didMutateIds = updates.filter(update => takeNewKey(newKeys, update, state)).length > 0\n\n      if (didMutateIds) {\n        state.ids = state.ids.map((id: any) => newKeys[id] || id)\n        return DidMutate.Both\n      } else {\n        return DidMutate.EntitiesOnly\n      }\n    }\n\n    return DidMutate.None\n  }\n\n  function upsertOneMutably(entity: T, state: R): DidMutate\n  function upsertOneMutably(entity: any, state: any): DidMutate {\n    return upsertManyMutably([entity], state)\n  }\n\n  function upsertManyMutably(entities: T[], state: R): DidMutate\n  function upsertManyMutably(entities: any[], state: any): DidMutate {\n    const added: any[] = []\n    const updated: any[] = []\n\n    for (const entity of entities) {\n      const id = selectId(entity)\n      if (id in state.entities) {\n        updated.push({ id, changes: entity })\n      } else {\n        added.push(entity)\n      }\n    }\n\n    const didMutateByUpdated = updateManyMutably(updated, state)\n    const didMutateByAdded = addManyMutably(added, state)\n\n    switch (true) {\n      case didMutateByAdded === DidMutate.None && didMutateByUpdated === DidMutate.None:\n        return DidMutate.None\n      case didMutateByAdded === DidMutate.Both || didMutateByUpdated === DidMutate.Both:\n        return DidMutate.Both\n      default:\n        return DidMutate.EntitiesOnly\n    }\n  }\n\n  return {\n    removeAll,\n    addOne: createStateOperator(addOneMutably),\n    addMany: createStateOperator(addManyMutably),\n    addAll: createStateOperator(addAllMutably),\n    updateOne: createStateOperator(updateOneMutably),\n    updateMany: createStateOperator(updateManyMutably),\n    upsertOne: createStateOperator(upsertOneMutably),\n    upsertMany: createStateOperator(upsertManyMutably),\n    removeOne: createStateOperator(removeOneMutably),\n    removeMany: createStateOperator(removeManyMutably)\n  }\n}\n","import { Comparer, EntityState, EntityStateAdapter, IdSelector, Update } from './models'\nimport { createStateOperator, DidMutate } from './state_adapter'\nimport { createUnsortedStateAdapter } from './unsorted_state_adapter'\n\nexport function createSortedStateAdapter<T>(\n  selectId: IdSelector<T>,\n  sort: Comparer<T>\n): EntityStateAdapter<T>\nexport function createSortedStateAdapter<T>(selectId: any, sort: any): any {\n  type R = EntityState<T>\n\n  const { removeOne, removeMany, removeAll } = createUnsortedStateAdapter(selectId)\n\n  function addOneMutably(entity: T, state: R): DidMutate\n  function addOneMutably(entity: any, state: any): DidMutate {\n    return addManyMutably([entity], state)\n  }\n\n  function addManyMutably(newModels: T[], state: R): DidMutate\n  function addManyMutably(newModels: any[], state: any): DidMutate {\n    const models = newModels.filter(model => !(selectId(model) in state.entities))\n\n    if (models.length === 0) {\n      return DidMutate.None\n    } else {\n      merge(models, state)\n      return DidMutate.Both\n    }\n  }\n\n  function addAllMutably(models: T[], state: R): DidMutate\n  function addAllMutably(models: any[], state: any): DidMutate {\n    state.entities = {}\n    state.ids = []\n\n    addManyMutably(models, state)\n\n    return DidMutate.Both\n  }\n\n  function updateOneMutably(update: Update<T>, state: R): DidMutate\n  function updateOneMutably(update: any, state: any): DidMutate {\n    return updateManyMutably([update], state)\n  }\n\n  function takeUpdatedModel(models: T[], update: Update<T>, state: R): boolean\n  function takeUpdatedModel(models: any[], update: any, state: any): boolean {\n    if (!(update.id in state.entities)) {\n      return false\n    }\n\n    const original = state.entities[update.id]\n    const updated = Object.assign({}, original, update.changes)\n    const newKey = selectId(updated)\n\n    delete state.entities[update.id]\n\n    models.push(updated)\n\n    return newKey !== update.id\n  }\n\n  function updateManyMutably(updates: Update<T>[], state: R): DidMutate\n  function updateManyMutably(updates: any[], state: any): DidMutate {\n    const models: T[] = []\n\n    const didMutateIds =\n      updates.filter(update => takeUpdatedModel(models, update, state)).length > 0\n\n    if (models.length === 0) {\n      return DidMutate.None\n    } else {\n      const originalIds = state.ids\n      const updatedIndexes: any[] = []\n      state.ids = state.ids.filter((id: any, index: number) => {\n        if (id in state.entities) {\n          return true\n        } else {\n          updatedIndexes.push(index)\n          return false\n        }\n      })\n\n      merge(models, state)\n\n      if (!didMutateIds && updatedIndexes.every((i: number) => state.ids[i] === originalIds[i])) {\n        return DidMutate.EntitiesOnly\n      } else {\n        return DidMutate.Both\n      }\n    }\n  }\n\n  function upsertOneMutably(entity: T, state: R): DidMutate\n  function upsertOneMutably(entity: any, state: any): DidMutate {\n    return upsertManyMutably([entity], state)\n  }\n\n  function upsertManyMutably(entities: T[], state: R): DidMutate\n  function upsertManyMutably(entities: any[], state: any): DidMutate {\n    const added: any[] = []\n    const updated: any[] = []\n\n    for (const entity of entities) {\n      const id = selectId(entity)\n      if (id in state.entities) {\n        updated.push({ id, changes: entity })\n      } else {\n        added.push(entity)\n      }\n    }\n\n    const didMutateByUpdated = updateManyMutably(updated, state)\n    const didMutateByAdded = addManyMutably(added, state)\n\n    switch (true) {\n      case didMutateByAdded === DidMutate.None && didMutateByUpdated === DidMutate.None:\n        return DidMutate.None\n      case didMutateByAdded === DidMutate.Both || didMutateByUpdated === DidMutate.Both:\n        return DidMutate.Both\n      default:\n        return DidMutate.EntitiesOnly\n    }\n  }\n\n  function merge(models: T[], state: R): void\n  function merge(models: any[], state: any): void {\n    models.sort(sort)\n\n    const ids: any[] = []\n\n    let i = 0\n    let j = 0\n\n    while (i < models.length && j < state.ids.length) {\n      const model = models[i]\n      const modelId = selectId(model)\n      const entityId = state.ids[j]\n      const entity = state.entities[entityId]\n\n      if (sort(model, entity) <= 0) {\n        ids.push(modelId)\n        i++\n      } else {\n        ids.push(entityId)\n        j++\n      }\n    }\n\n    if (i < models.length) {\n      state.ids = ids.concat(models.slice(i).map(selectId))\n    } else {\n      state.ids = ids.concat(state.ids.slice(j))\n    }\n\n    models.forEach(model => {\n      state.entities[selectId(model)] = model\n    })\n  }\n\n  return {\n    removeOne,\n    removeMany,\n    removeAll,\n    addOne: createStateOperator(addOneMutably),\n    updateOne: createStateOperator(updateOneMutably),\n    upsertOne: createStateOperator(upsertOneMutably),\n    addAll: createStateOperator(addAllMutably),\n    addMany: createStateOperator(addManyMutably),\n    updateMany: createStateOperator(updateManyMutably),\n    upsertMany: createStateOperator(upsertManyMutably)\n  }\n}\n","import { Comparer, EntityAdapter, EntityDefinition, IdSelector } from './models'\nimport { createInitialStateFactory } from './entity_state'\nimport { createSelectorsFactory } from './state_selectors'\nimport { createSortedStateAdapter } from './sorted_state_adapter'\nimport { createUnsortedStateAdapter } from './unsorted_state_adapter'\n\nexport function createEntityAdapter<T>(\n  options: {\n    selectId?: IdSelector<T>\n    sortComparer?: false | Comparer<T>\n  } = {}\n): EntityAdapter<T> {\n  const { selectId, sortComparer }: EntityDefinition<T> = {\n    sortComparer: false,\n    selectId: (instance: any) => instance.id,\n    ...options\n  }\n\n  const stateFactory = createInitialStateFactory<T>()\n  const selectorsFactory = createSelectorsFactory<T>()\n  const stateAdapter = sortComparer\n    ? createSortedStateAdapter(selectId, sortComparer)\n    : createUnsortedStateAdapter(selectId)\n\n  return {\n    selectId,\n    sortComparer,\n    ...stateFactory,\n    ...selectorsFactory,\n    ...stateAdapter\n  }\n}\n","export type ComparerStr<T> = {\n  (a: T, b: T): string\n}\n\nexport type ComparerNum<T> = {\n  (a: T, b: T): number\n}\n\nexport type Comparer<T> = ComparerNum<T> | ComparerStr<T>\n\nexport type IdSelectorStr<T> = {\n  (model: T): string\n}\n\nexport type IdSelectorNum<T> = {\n  (model: T): number\n}\n\nexport type IdSelector<T> = IdSelectorStr<T> | IdSelectorNum<T>\n\nexport type DictionaryNum<T> = {\n  [id: number]: T\n}\n\nexport abstract class Dictionary<T> implements DictionaryNum<T> {\n  [id: string]: T\n}\n\nexport type UpdateStr<T> = {\n  id: string\n  changes: Partial<T>\n}\n\nexport type UpdateNum<T> = {\n  id: number\n  changes: Partial<T>\n}\n\nexport type Update<T> = UpdateStr<T> | UpdateNum<T>\n\nexport interface EntityState<T> {\n  ids: string[] | number[]\n  entities: Dictionary<T>\n}\n\nexport interface EntityDefinition<T> {\n  selectId: IdSelector<T>\n  sortComparer: false | Comparer<T>\n}\n\nexport interface EntityStateAdapter<T> {\n  addOne<S extends EntityState<T>>(entity: T, state: S): S\n  addMany<S extends EntityState<T>>(entities: T[], state: S): S\n  addAll<S extends EntityState<T>>(entities: T[], state: S): S\n\n  removeOne<S extends EntityState<T>>(key: string, state: S): S\n  removeOne<S extends EntityState<T>>(key: number, state: S): S\n\n  removeMany<S extends EntityState<T>>(keys: string[], state: S): S\n  removeMany<S extends EntityState<T>>(keys: number[], state: S): S\n\n  removeAll<S extends EntityState<T>>(state: S): S\n\n  updateOne<S extends EntityState<T>>(update: Update<T>, state: S): S\n  updateMany<S extends EntityState<T>>(updates: Update<T>[], state: S): S\n\n  upsertOne<S extends EntityState<T>>(entity: T, state: S): S\n  upsertMany<S extends EntityState<T>>(entities: T[], state: S): S\n}\n\nexport type EntitySelectors<T, V> = {\n  selectIds: (state: V) => string[] | number[]\n  selectEntities: (state: V) => Dictionary<T>\n  selectAll: (state: V) => T[]\n  selectTotal: (state: V) => number\n}\n\nexport interface EntityAdapter<T> extends EntityStateAdapter<T> {\n  selectId: IdSelector<T>\n  sortComparer: false | Comparer<T>\n  getInitialState(): EntityState<T>\n  getInitialState<S extends object>(state: S): EntityState<T> & S\n  getSelectors(): EntitySelectors<T, EntityState<T>>\n  getSelectors<V>(selectState: (state: V) => EntityState<T>): EntitySelectors<T, V>\n}\n"],"names":[],"mappings":"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"}